<div class="taxon">

  <div data-product-carousel="" data-product-carousel-taxon-id="trending" class="mb-3" data-product-carousel-loaded="true">
    <p class="font-weight-bold text-center homepage-carousel-text text-uppercase">
      <%= link_to taxon.name, seo_url(taxon),class: "list-group-item list-group-item-action" %>
  </p>
    <% if taxon.products.empty? %>

      <div id="trending-desktop" class="carousel slide d-none d-md-block homepage-carousel" data-interval="false">
        <div class="carousel-inner carousel-inner-width">
          <div class="carousel-item active">
            <div class="container position-relative">
          <%= Spree.t(:no_products_found) %>
            </div>
          </div>
        </div>
      </div>

    <% else %>

      <div id="taxon-<%= taxon.try(:id) %>" class="carousel slide d-md-none homepage-carousel" data-interval="8000">
        <div class="carousel-inner">
          <% taxon.products.each_with_index do | product,index|  %>
            <% url = spree.product_path(product, taxon_id: taxon.try(:id)) %>
          <div class="carousel-item <%= index==0 ? "active" : "" %>">
            <div class="container">
              <div class="row carousel-items-container">
                <div class="col-12">
                  <a class="" href="<%= url %>">
                    <%= large_image(product, class:"product-component-image d-block mw-100 w-100", alt:"#{product.name}") %>
                    <%#= plp_and_carousel_image(product, "w-100") %>
                  <div>
                    <div class="product-component-name" title="<%= product.name %>">
                      <%= product.name %>
                    </div>
                    <div class="product-component-price"><%= product.price %> <%= current_currency %></div>
                  </div>
                  </a>
                </div>
              </div>
            </div>
          </div>

        <% end %>


        </div>


        <a class="d-flex position-absolute justify-content-center align-items-center carousel-icon-control carousel-icon-control--previous" href="#taxon-<%= taxon.try(:id) %>" role="button" data-slide="prev">
      <span class="d-flex justify-content-center align-items-center carousel-icon-control-rounded" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 11.344 21.156" width="20px" class="spree-icon spree-icon-arrow spree-icon-arrow-left"><path d="m42.617 25.669a.685.685 0 0 0 .968 0 .685.685 0 0 0 0-.968l-8.515-8.516 8.516-8.516a.685.685 0 0 0 -.968-.968l-9.017 9a.685.685 0 0 0 0 .968z" fill="currentColor" transform="matrix(-1 0 0 -1 44.744 26.869)"></path></svg>

      </span>
          <span class="sr-only">Previous</span>
        </a>

        <a class="d-flex position-absolute justify-content-center align-items-center carousel-icon-control carousel-icon-control--next" href="#taxon-<%= taxon.try(:id) %>" role="button" data-slide="next">
      <span class="d-flex justify-content-center align-items-center carousel-icon-control-rounded" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 11.344 21.156" width="20px" class="spree-icon spree-icon-arrow spree-icon-arrow-right"><path d="m42.617 25.669a.685.685 0 0 0 .968 0 .685.685 0 0 0 0-.968l-8.515-8.516 8.516-8.516a.685.685 0 0 0 -.968-.968l-9.017 9a.685.685 0 0 0 0 .968z" fill="currentColor" transform="matrix(-1 0 0 -1 44.744 26.869)"></path></svg>

      </span>
          <span class="sr-only">Next</span>
        </a>
      </div>

      <div id="trending-desktop-<%= taxon.try(:id) %>" class="carousel slide d-none d-md-block homepage-carousel" data-interval="3000">
        <% i=0 %>
        <div class="carousel-inner carousel-inner-width">
          <% taxon.products.each_slice(3) do | product_slice|  %>

          <div class="carousel-item <%= i==0 ? "active" : "" %>">
            <div class="container position-relative">
              <a class="d-flex position-absolute justify-content-center align-items-center carousel-icon-control carousel-icon-control--previous" href="#trending-desktop-<%= taxon.try(:id) %>" role="button" data-slide="prev">
              <span class="d-flex justify-content-center align-items-center carousel-icon-control-rounded" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 11.344 21.156" width="20px" class="spree-icon spree-icon-arrow spree-icon-arrow-left"><path d="m42.617 25.669a.685.685 0 0 0 .968 0 .685.685 0 0 0 0-.968l-8.515-8.516 8.516-8.516a.685.685 0 0 0 -.968-.968l-9.017 9a.685.685 0 0 0 0 .968z" fill="currentColor" transform="matrix(-1 0 0 -1 44.744 26.869)"></path></svg>

              </span>
                <span class="sr-only">Previous</span>
              </a>

              <div class="row carousel-items-container">
                <% product_slice.each_with_index  do |product,index| %>
                  <% url = spree.product_path(product, taxon_id: taxon.try(:id)) %>
                <div class="col-4">
                  <a class="h-100 d-flex flex-column justify-content-between" href="<%= url %>">
                    <%= large_image(product, class:"product-component-image d-block mw-100 w-100", alt:"#{product.name}") %>
                    <div>
                      <div class="product-component-name" title="<%= product.name %>">
                        <%= product.name %>
                      </div>
                      <div class="product-component-price"><%= product.price %> <%= product.cost_currency %></div>
                    </div>
                  </a>
                </div>
                  <% end %>
              </div>
              <% i = i+1 %>
              <a class="d-md-flex position-absolute justify-content-center align-items-center carousel-icon-control carousel-icon-control--next" href="#trending-desktop-<%= taxon.try(:id) %>" role="button" data-slide="next">
              <span class="d-flex justify-content-center align-items-center carousel-icon-control-rounded" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 11.344 21.156" width="20px" class="spree-icon spree-icon-arrow spree-icon-arrow-right"><path d="m42.617 25.669a.685.685 0 0 0 .968 0 .685.685 0 0 0 0-.968l-8.515-8.516 8.516-8.516a.685.685 0 0 0 -.968-.968l-9.017 9a.685.685 0 0 0 0 .968z" fill="currentColor" transform="matrix(-1 0 0 -1 44.744 26.869)"></path></svg>

              </span>
                <span class="sr-only">Next</span>
              </a>
            </div>
          </div>
          <% end %>
        </div>
      </div>
            <%#= render 'spree/shared/carousel_4_products', id: @taxon.permalink, products: @products %>

    <% end %>
    <%# end %>

  </div>

 </div>

<style>
  #trending-desktop {
    margin-top: 2%;
  }
</style>